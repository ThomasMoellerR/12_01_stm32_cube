
/******************************************************************************
*  File           :  TIM4.c
*  Version        :  1
*  Last Changes   :  2019-05-11 13:46:42
******************************************************************************/

/******************************************************************************
*  Include Files
******************************************************************************/

#include "typ.h"
#include "TIM4.h"
#include "main.h"
#include "ctl.h"
#include "led.h"

/******************************************************************************
*  Local Constants
******************************************************************************/

/******************************************************************************
*  Local Type Definitions
******************************************************************************/

#define TIMERSR 	(TIM_IT_UPDATE ^ 0xffff)

/******************************************************************************
*  Local Variables
******************************************************************************/

TIM_HandleTypeDef htim4;

/******************************************************************************
*  Global Variables
******************************************************************************/


/******************************************************************************
*  Local Function Prototypes
******************************************************************************/

/******************************************************************************
*  Local Functions
******************************************************************************/

/******************************************************************************
*  Global Functions
******************************************************************************/

/******************************************************************************
*  Function Name  :  
*  Description    :  
*  Parameter(s)   :  
*  Return Value   :  
******************************************************************************/

void TIM4_Ini (void)
{
	HAL_TIM_Base_Start_IT(&htim4);
	HAL_NVIC_EnableIRQ(TIM4_IRQn);
}

/******************************************************************************
*  Function Name  :
*  Description    :
*  Parameter(s)   :
*  Return Value   :
******************************************************************************/

void TIM4_HAL_TIM_PeriodElapsedCallback(TIM_HandleTypeDef *htim)
{

/*
	SM16126_DAT_C_SET;

	SM16126_DAT_C_RESET;
	*/

	/*

	static uint8_t Layer = 0;
	static uint8_t Digit = 0;
	if ((TIM4->SR & TIM_IT_UPDATE) != (uint16_t)RESET && (TIM4->DIER & TIM_IT_UPDATE) != (uint16_t)RESET)
	{
		TIM4->SR = TIMERSR;

		if (++Layer >= 12)
		{
			Layer = 0;
			if (++Digit >= 8)
				Digit = 0;

			TIM4->ARR = ScanTimeData[Digit];
		}

		SM16126_OE_SET;
		LayerChoose(LayerChar[Layer]);
		Set_row(Layer,Digit);

		SM16126_OE_RESET;
	}

	*/
}

/******************************************************************************
*  Changes        :  
*                    
*                    
*                    
******************************************************************************/

/******************************************************************************
*  END OF FILE    :  TIM4.h
******************************************************************************/
